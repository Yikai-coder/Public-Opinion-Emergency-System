{% extends 'base.html'%}
{% load static %}
{%block custom-css%}
<link rel="stylesheet" href="{%static 'hotsearch_analysis/css/hotsearch_analysis.css' %}">
{%endblock%}
{% block body-content %}
{{item.title}}

<div class="card-body p-10">
    <!--<div class="card-title">数据概览</div>-->
    <div class="col-lg-12">
        <div class="card radar-chart-example">
            <div class="card-header d-flex align-items-center">
                <h4>数据概览</h4>
            </div>

            <div class="card-body border-top">
                <div class="row m-t-10" id="dataOverview" style="min-height: 85px;">
                    <div class="col-sm-12 col-md-6 col-lg-3">
                        <div class="d-flex align-items-center">
                            <div class="m-r-20">
                                <div data-label="20%" class="css-bar m-b-0 css-bar-primary css-bar-100"><i
                                        class="mdi mdi-database text-info"></i></div>
                                <svg t="1673582936908" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="1406" width="70" height="70">
                                    <path
                                        d="M522.666667 96l8.533333 0.042667a910.08 910.08 0 0 1 91.562667 5.333333l14.549333 1.706667 15.402667 2.133333 15.125333 2.410667 7.573333 1.322666 14.890667 2.837334c125.205333 25.322667 212.928 79.488 216.256 150.677333l0.106667 4.202667v448c0 73.258667-88.704 129.066667-216.362667 154.88l-14.890667 2.837333-7.573333 1.322667-15.125333 2.389333-15.402667 2.133333c-36.266667 4.650667-74.773333 7.104-114.645333 7.104-39.872 0-78.378667-2.453333-114.645334-7.104l-15.402666-2.133333-15.125334-2.389333c-137.088-23.189333-235.264-79.488-238.72-154.901334L138.666667 714.666667v-448l0.106666-4.202667c3.328-71.189333 91.050667-125.354667 216.256-150.677333l14.890667-2.837334 7.573333-1.322666 15.125334-2.389334 15.402666-2.133333a892.202667 892.202667 0 0 1 97.642667-6.954667L522.666667 96z m145.173333 543.04l-15.125333 2.389333-15.402667 2.133334c-36.266667 4.650667-74.773333 7.104-114.645333 7.104-39.872 0-78.378667-2.453333-114.645334-7.104l-15.402666-2.133334-15.125334-2.389333c-71.488-12.096-132.416-33.194667-174.826666-61.312V714.666667c0 20.949333 24.170667 42.773333 65.066666 61.184l9.749334 4.181333c15.04 6.186667 32 11.925333 50.602666 17.024l12.650667 3.306667c12.864 3.2 26.453333 6.144 40.597333 8.704l14.378667 2.453333 14.741333 2.197333c9.962667 1.386667 20.16 2.602667 30.570667 3.626667l15.765333 1.408 16.064 1.109333 16.362667 0.810667a845.994667 845.994667 0 0 0 66.901333 0l16.362667-0.810667 16.064-1.109333 15.786667-1.408c10.389333-1.024 20.586667-2.24 30.549333-3.626667l14.741333-2.197333 14.378667-2.453333c14.165333-2.56 27.733333-5.482667 40.597333-8.704l12.650667-3.306667c18.602667-5.12 35.562667-10.837333 50.602667-17.024l9.749333-4.181333c39.317333-17.706667 63.189333-38.549333 64.96-58.773334l0.106667-2.410666v-136.96c-42.389333 28.138667-103.317333 49.237333-174.826667 61.333333zM842.666667 364.373333c-40.298667 26.730667-97.28 47.104-164.202667 59.456l-10.666667 1.877334-15.104 2.389333-15.402666 2.133333c-36.266667 4.650667-74.773333 7.104-114.645334 7.104-34.176 0-67.349333-1.792-98.986666-5.248l-15.658667-1.856-15.402667-2.133333-15.125333-2.389333c-71.488-12.096-132.416-33.194667-174.826667-61.312V480c0 20.949333 24.170667 42.773333 65.066667 61.184l9.749333 4.181333c15.04 6.186667 32 11.925333 50.602667 17.024l12.650667 3.306667c12.864 3.2 26.453333 6.144 40.597333 8.704l14.378667 2.453333 14.741333 2.197334c9.962667 1.386667 20.16 2.602667 30.570667 3.626666l15.765333 1.408 16.064 1.109334 16.362667 0.810666a845.994667 845.994667 0 0 0 66.901333 0l16.362667-0.810666 16.064-1.109334 15.786666-1.408c10.389333-1.024 20.586667-2.24 30.549334-3.626666l14.741333-2.197334 14.378667-2.453333c14.165333-2.56 27.733333-5.482667 40.597333-8.704l12.650667-3.306667c18.602667-5.12 35.562667-10.837333 50.602666-17.024l9.749334-4.181333c39.317333-17.706667 63.189333-38.549333 64.96-58.773333l0.106666-2.410667v-115.626667zM522.666667 160l-8.448 0.042667-12.586667 0.213333-12.416 0.405333-16.362667 0.810667-16.064 1.109333-15.786666 1.408c-6.933333 0.682667-13.76 1.450667-20.501334 2.304l-10.026666 1.322667-14.762667 2.197333-14.378667 2.453334c-10.624 1.92-20.906667 4.053333-30.826666 6.336l-9.770667 2.346666-12.650667 3.328c-15.488 4.266667-29.866667 8.96-42.922666 13.973334l-7.68 3.050666-9.749334 4.181334c-40.896 18.410667-65.066667 40.234667-65.066666 61.184 0 20.053333 22.122667 40.874667 59.84 58.773333l5.226666 2.410667 9.749334 4.181333c12.522667 5.162667 26.389333 10.005333 41.450666 14.421333l9.173334 2.602667 12.629333 3.306667c9.642667 2.410667 19.690667 4.650667 30.08 6.72l10.517333 1.984 14.378667 2.453333 14.741333 2.197333c6.634667 0.938667 13.376 1.770667 20.224 2.56l10.346667 1.066667 15.765333 1.408 16.064 1.109333 16.362667 0.810667a845.994667 845.994667 0 0 0 55.872 0.362667l11.029333-0.362667 16.362667-0.810667 16.064-1.109333 15.786667-1.408c6.933333-0.682667 13.76-1.450667 20.501333-2.304l10.026667-1.322667 14.762666-2.197333 14.378667-2.453333c10.624-1.92 20.906667-4.053333 30.826667-6.336l9.770666-2.346667 12.650667-3.328c15.488-4.266667 29.866667-8.96 42.922667-13.973333l7.68-3.050667 9.749333-4.181333c40.896-18.410667 65.066667-40.234667 65.066667-61.184 0-20.053333-22.122667-40.874667-59.84-58.773334l-5.226667-2.410666-9.749333-4.181334a424.469333 424.469333 0 0 0-41.450667-14.421333l-9.173333-2.602667-12.629334-3.306666a623.658667 623.658667 0 0 0-30.08-6.72l-10.517333-1.984-14.378667-2.453334-14.741333-2.197333a765.994667 765.994667 0 0 0-20.224-2.56l-10.346667-1.066667-15.765333-1.408-16.064-1.109333-16.362667-0.810667c-7.317333-0.298667-14.72-0.490667-22.186666-0.597333L522.666667 160z"
                                        fill="#2c2c2c" p-id="1407"></path>
                                </svg>
                            </div>
                            <div style="position: relative;"><span>全部信息</span>
                                <h3 class="m-b-0"><a>{{item.weibo_count}}</a></h3>
                                <div class="progress m-t-10">
                                    <div class="progress-bar bg-cyan" role="progressbar" style="width: 100%"
                                        aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-3">
                        <div class="d-flex align-items-center">
                            <div class="m-r-20">
                                <div data-label="20%" class="css-bar m-b-0 css-bar-success css-bar-89"><i
                                        class="mdi mdi-emoticon-happy text-cyan"></i></div>
                                <svg t="1673579709315" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="1131" width="70" height="70">
                                    <path
                                        d="M682.666667 554.666667v21.333333c0 81.066667-68.266667 149.333333-149.333334 149.333333S384 657.066667 384 576V554.666667h42.666667v21.333333c0 59.733333 46.933333 106.666667 106.666666 106.666667s106.666667-46.933333 106.666667-106.666667V554.666667h42.666667z m-149.333334 341.333333C332.8 896 170.666667 733.866667 170.666667 533.333333S332.8 170.666667 533.333333 170.666667 896 332.8 896 533.333333 733.866667 896 533.333333 896z m0-42.666667c174.933333 0 320-145.066667 320-320S708.266667 213.333333 533.333333 213.333333 213.333333 358.4 213.333333 533.333333 358.4 853.333333 533.333333 853.333333zM469.333333 384v85.333333h-42.666666V384h42.666666z m170.666667 0v85.333333h-42.666667V384h42.666667z"
                                        fill="#444444" p-id="1132"></path>
                                </svg>
                            </div>
                            <div style="position: relative;"><span>积极信息</span>
                                <h3 class="m-b-0"><a>{{item.positive_count}}</a></h3>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40"
                                        aria-valuemin="0" aria-valuemax="100"
                                        style="width: {% widthratio item.positive_count item.weibo_count 100 %}%">
                                        <span class="sr-only">40% Complete (success)</span>
                                    </div>
                                </div>
                                <div style="position: absolute;right: -55px;bottom: -8px;">
                                    {% widthratio item.positive_count item.weibo_count 100 %}%
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-3">
                        <div class="d-flex align-items-center">

                            <div class="m-r-20">
                                <div data-label="20%" class="css-bar m-b-0 css-bar-success css-bar-89"><i
                                        class="mdi mdi-emoticon-happy text-cyan"></i></div>
                                <svg t="1673579753703" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="1409" width="70" height="70">
                                    <path
                                        d="M533.333333 896C332.8 896 170.666667 733.866667 170.666667 533.333333S332.8 170.666667 533.333333 170.666667 896 332.8 896 533.333333 733.866667 896 533.333333 896z m0-42.666667c174.933333 0 320-145.066667 320-320S708.266667 213.333333 533.333333 213.333333 213.333333 358.4 213.333333 533.333333 358.4 853.333333 533.333333 853.333333zM426.666667 640h213.333333v42.666667h-213.333333v-42.666667z m42.666666-213.333333v85.333333h-42.666666v-85.333333h42.666666z m170.666667 0v85.333333h-42.666667v-85.333333h42.666667z"
                                        fill="#444444" p-id="1410"></path>
                                </svg>
                            </div>
                            <div style="position: relative;"><span>中性信息</span>
                                <div id="neutral_count">
                                    <h3 class="m-b-0"><a>{{item.neutral_count}}</a></h3>
                                </div>
                                <div class="progress m-t-10">
                                    <div class="progress-bar bg-yellow" role="progressbar"
                                        style="width: {% widthratio item.neutral_count item.weibo_count 100 %}%"
                                        aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <div style="position: absolute;right: -55px;bottom: -8px;">
                                    {% widthratio item.neutral_count item.weibo_count 100 %}%
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-3">
                        <div class="d-flex align-items-center">
                            <div class="m-r-20">
                                <div data-label="20%" class="css-bar m-b-0 css-bar-danger css-bar-11"><i
                                        class="mdi mdi-emoticon-sad text-danger"></i></div>
                                <svg t="1673579309865" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="2829" width="70" height="70">
                                    <path
                                        d="M640 725.333333v-21.333333c0-59.733333-46.933333-106.666667-106.666667-106.666667S426.666667 644.266667 426.666667 704v21.333333H384v-21.333333c0-81.066667 68.266667-149.333333 149.333333-149.333333s149.333333 68.266667 149.333334 149.333333v21.333333h-42.666667zM533.333333 170.666667c200.533333 0 362.666667 162.133333 362.666667 362.666666S733.866667 896 533.333333 896 170.666667 733.866667 170.666667 533.333333 332.8 170.666667 533.333333 170.666667z m0 42.666666C358.4 213.333333 213.333333 358.4 213.333333 533.333333S358.4 853.333333 533.333333 853.333333s320-145.066667 320-320S708.266667 213.333333 533.333333 213.333333z m64 256V384h42.666667v85.333333h-42.666667z m-170.666666 0V384h42.666666v85.333333h-42.666666z"
                                        fill="#444444" p-id="2830"></path>
                                </svg>
                            </div>
                            <div style="position: relative;"><span>消极信息</span>
                                <h3 class="m-b-0"><a>{{item.negative_count}}</a></h3>
                                <div class="progress m-t-10">
                                    <div class="progress-bar bg-green" role="progressbar"
                                        style="width: {% widthratio item.negative_count item.weibo_count 100 %}%"
                                        aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <div style="position: absolute;right: -55px;bottom: -8px;">
                                    {% widthratio item.negative_count item.weibo_count 100 %}%
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class='col-lg-12'>
        <div class='row'>
            <div class="col-lg-6">
                <div class="card m-h-372">
                    <div class="card-body overview-content">
                        <h4 class="card-title">情感占比</h4>
                        <div id="emotionRateChart" style="height: 300px; width: 100%; margin: auto;" class="m-t-20 c3">
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="card m-h-372">
                    <div class="card-body overview-content">
                        <h4 class="card-title">关键词云</h4>
                        <div id="wordCloudChart" style="height: 300px; width: 100%; margin: auto;" class="m-t-20 c3">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class='col-lg-12'>
        <div class="card m-h-372">
            <div class='row'>
                <div class="card-body overview-content">
                    <h4 class="card-title">情感演化趋势</h4>
                    <div id="sentimentTrendChart" style="height: 300px; width: 100%; margin: auto;" class="m-t-20 c3">
                    </div>
                </div>
            </div>
        </div> 
    </div>
    <div class='col-lg-12'>
        <div class='card'>
            <div class='card-body'>
                <h4 class="card-title">
                    <i class=" fa fas"></i> 高热度微博
                </h4>
                <div class="table-responsive">
                    <table id="hotEventRankingTable" class="table v-middle hot-rank"
                        style="position: relative; min-height: 150px;">
                        {% for weibo in item.hotweibos %}
                        <tr>
                            <td>
                                <div>
                                    <div style="display:flex;">
                                        <a target="_blank" title="{{weibo.text}}" style="font-weight: 500;"
                                            href="https://weibo.com/{{weibo.mid}}/{{weibo.bid}}">
                                            <span class="v-hot v-hot1">{{weibo.nick_name}}</span>
                                        </a>
                                        <div style="margin-left: auto;">
                                            <span style="white-space: nowrap;margin-right: 15px;"><i
                                                    class="mdi mdi-clock"></i> 时间：{{weibo.created_at}}</span>
                                            <span style="margin-right: 15px;"
                                                class="link moodzx">情绪：{{weibo.sentiment}}</span>
                                            <span style="font-size: smaller;">{{ weibo.attitudes_count | add:weibo.comments_count | add:weibo.reposts_count}}<i
                                                    class=" fa fas fa-fire"></i></span>
                                        </div>
                                    </div>
                                    <div class="text-over-2">
                                        {{weibo.text | slice:":150"}}
                                    </div>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class='col-lg-12'>
        <div class='card'>
            <div class='card-body'>
                <h4 class="card-title">
                    <i class=" fa fas"></i> 媒体观点
                </h4>
                <div class="table-responsive">
                    <table id="hotEventRankingTable" class="table v-middle hot-rank"
                        style="position: relative; min-height: 150px;">
                        {% for weibo in item.media_weibos %}
                        <tr>
                            <td>
                                <div>
                                    <div style="display:flex;">
                                        <a target="_blank" title="{{weibo.text}}" style="font-weight: 500;"
                                            href="https://weibo.com/{{weibo.mid}}/{{weibo.bid}}">
                                            <span class="v-hot v-hot1">{{weibo.nick_name}}</span>
                                        </a>
                                        <div style="margin-left: auto;">
                                            <span style="white-space: nowrap;margin-right: 15px;"><i
                                                    class="mdi mdi-clock"></i> 时间：{{weibo.created_at}}</span>
                                            {% comment %} <span
                                                style="white-space: nowrap;margin-right: 15px;">来源：{{weibo.nick_name}}</span>
                                            {% endcomment %}
                                            <span style="margin-right: 15px;"
                                                class="link moodzx">情绪：{{weibo.sentiment}}</span>
                                            <span style="font-size: smaller;">{{ weibo.attitudes_count | add:weibo.comments_count | add:weibo.reposts_count}}<i
                                                    class=" fa fas fa-fire"></i></span>
                                        </div>
                                    </div>
                                    <div class="text-over-2">
                                        {{weibo.text | slice:":150"}}
                                    </div>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

{% comment %} Pass data to Javascript to process {% endcomment %}
<div id="happySentimentCount" style="display:none">{{item.happy_sentiment_count}}</div>
<div id="surpriseSentimentCount" style="display:none">{{item.surprise_sentiment_count}}</div>
<div id="sadSentimentCount" style="display:none">{{item.sad_sentiment_count}}</div>
<div id="angrySentimentCount" style="display:none">{{item.angry_sentiment_count}}</div>
<div id="fearSentimentCount" style="display:none">{{item.fear_sentiment_count}}</div>
<div id="neutralSentimentCount" style="display:none">{{item.neutral_sentiment_count}}</div>
<div id="wordCloudMeta" style="display:none">{{item.wordcloud_meta}}</div>
<div class="emotionWithDate" style="display: none">happy 2020-01-01</div>
<div class="emotionWithDate" style="display: none">sad 2020-02-01</div>

{%endblock%}


{%block custom-script%}
<script>
        var sentimentEachDate = {{item.sentiment_distribution | safe}};
        console.log(sentimentEachDate)
</script>
<script src="{%static 'hotsearch_analysis/js/hotsearch_detail.js' %}"></script>
<script src="{%static 'vendor/echarts/echarts.js' %}"></script>
<script src="{%static 'vendor/echarts/echarts-wordcloud.js' %}"></script>
{%endblock%}